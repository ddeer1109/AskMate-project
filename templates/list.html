{% extends 'base.html' %}
{% import 'blocks.html' as blocks %}

{% block head %}

    {{ super() }}

{% endblock %}

{% block header %}
    {{ super() }}
{% endblock %}

{% block content %}
    <h1 class="display-3"><i class="fas fa-home text-warning"></i> Home</h1>
    <hr>

    {% if sorted %}
        {% set displayed_headers = ['post_time', 'vote_number', 'view_number', 'title', 'message', 'image'] %}
        {% set page_header = 'Detailed view' %}
        {{ blocks.generate_sorting_panel() }}

    {% elif searched %}
        {% set displayed_headers = ['post_time', 'vote_number', 'view_number', 'title', 'message', 'image'] %}
        {% set page_header = 'Search results' %}

    {% elif questions|length == 0 %}
        {% set page_header = '<h3 class="display-5">No questions to display</h3>'%}

    {% else %}

        {% set page_header = 'Five newest questions' %}
        {% set displayed_headers = ['post_time', 'title', 'message', 'image'] %}

    {% endif %}


    <table class="table table-striped table-hover">

        <h3 class="display-5">
            {{ page_header|safe }}
        </h3>
        <tr>
            {% for header in displayed_headers %}
            <th class="main {{ header }}">
                {{ header.capitalize().replace('_', ' ') }}
            </th>
            {% endfor %}
        </tr>


    {% for question in questions %}
        <tr>

        {% for data in displayed_headers %}

            <td class="{{ data }}">
            {% if data == "title" %}

                <a href="question/{{ question["id"] }}">{{ question[data]|safe }}</a>

            {% elif data == "image" %}

                {{ blocks.get_image(
                        question['image'],
                        entry_id=question['id'],
                        entry_type='question') }}

            {% elif data == "message" %}
                {{ question[data]|safe }}
                {{ blocks.generate_accordion_answer_section(question, questions_id_with_highlighted_answers) }}

            {% else %}

                {{ question[data] }}

            {% endif %}
            </td>

        {% endfor %}

        </tr>
    {% endfor %}

    </table>
    <br>

    {% if not sorted %}
        <a href="/list" class="btn btn-primary">All questions</a>
    {% endif %}

    <a href="{{ url_for('display_add_question') }}" class="btn btn-primary">Add question</a>

{% endblock %}